<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1217px" preserveAspectRatio="none" style="width:1065px;height:1217px;" version="1.1" viewBox="0 0 1065 1217" width="1065px" zoomAndPan="magnify"><defs><filter height="300%" id="f138p7xaek87qb" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="326" x="366" y="29.4023">Payment process activated by the PSP</text><rect fill="#FFFFFF" filter="url(#f138p7xaek87qb)" height="41.9658" style="stroke:#A80036;stroke-width:1.0;" width="10" x="300" y="294.8955"/><rect fill="#FFFFFF" filter="url(#f138p7xaek87qb)" height="41.9658" style="stroke:#A80036;stroke-width:1.0;" width="10" x="300" y="591.6904"/><rect fill="#FFFFFF" filter="url(#f138p7xaek87qb)" height="49.6211" style="stroke:#A80036;stroke-width:1.0;" width="10" x="300" y="1045.0039"/><rect fill="#FFFFFF" filter="url(#f138p7xaek87qb)" height="173.208" style="stroke:#A80036;stroke-width:1.0;" width="10" x="525" y="502.4141"/><rect fill="#FFFFFF" filter="url(#f138p7xaek87qb)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="525" y="944.0723"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="305" x2="305" y1="123.6875" y2="1132.9355"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="529.5" x2="529.5" y1="123.6875" y2="1132.9355"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="725" x2="725" y1="123.6875" y2="1132.9355"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="922.5" x2="922.5" y1="123.6875" y2="1132.9355"/><rect fill="#FEFECE" filter="url(#f138p7xaek87qb)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="32" x="287" y="88.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="294" y="108.7344">PA</text><rect fill="#FEFECE" filter="url(#f138p7xaek87qb)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="32" x="287" y="1131.9355"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="294" y="1152.4707">PA</text><rect fill="#FEFECE" filter="url(#f138p7xaek87qb)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="51" x="502.5" y="88.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="509.5" y="108.7344">Nodo</text><rect fill="#FEFECE" filter="url(#f138p7xaek87qb)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="51" x="502.5" y="1131.9355"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="509.5" y="1152.4707">Nodo</text><rect fill="#FEFECE" filter="url(#f138p7xaek87qb)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="38" x="704" y="88.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="24" x="711" y="108.7344">PSP</text><rect fill="#FEFECE" filter="url(#f138p7xaek87qb)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="38" x="704" y="1131.9355"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="24" x="711" y="1152.4707">PSP</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="904.5" y="120.7344">User</text><ellipse cx="923" cy="50.1992" fill="#FEFECE" filter="url(#f138p7xaek87qb)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M923,58.1992 L923,85.1992 M910,66.1992 L936,66.1992 M923,85.1992 L910,100.1992 M923,85.1992 L936,100.1992 " fill="none" filter="url(#f138p7xaek87qb)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="904.5" y="1145.4707">User</text><ellipse cx="923" cy="1158.4238" fill="#FEFECE" filter="url(#f138p7xaek87qb)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M923,1166.4238 L923,1193.4238 M910,1174.4238 L936,1174.4238 M923,1193.4238 L910,1208.4238 M923,1193.4238 L936,1208.4238 " fill="none" filter="url(#f138p7xaek87qb)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FFFFFF" filter="url(#f138p7xaek87qb)" height="41.9658" style="stroke:#A80036;stroke-width:1.0;" width="10" x="300" y="294.8955"/><rect fill="#FFFFFF" filter="url(#f138p7xaek87qb)" height="41.9658" style="stroke:#A80036;stroke-width:1.0;" width="10" x="300" y="591.6904"/><rect fill="#FFFFFF" filter="url(#f138p7xaek87qb)" height="49.6211" style="stroke:#A80036;stroke-width:1.0;" width="10" x="300" y="1045.0039"/><rect fill="#FFFFFF" filter="url(#f138p7xaek87qb)" height="173.208" style="stroke:#A80036;stroke-width:1.0;" width="10" x="525" y="502.4141"/><rect fill="#FFFFFF" filter="url(#f138p7xaek87qb)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="525" y="944.0723"/><rect fill="#EEEEEE" filter="url(#f138p7xaek87qb)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1058" x="0" y="154.3428"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1058" y1="154.3428" y2="154.3428"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1058" y1="157.3428" y2="157.3428"/><rect fill="#EEEEEE" filter="url(#f138p7xaek87qb)" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="102" x="478" y="143.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="84" x="484" y="160.2559">verify phase</text><polygon fill="#0000FF" points="736,194.3086,726,198.3086,736,202.3086,732,198.3086" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="730" x2="922" y1="198.3086" y2="198.3086"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="742" y="193.5664">Payment Notice</text><polygon fill="#A80036" points="541,236.2744,531,240.2744,541,244.2744,537,240.2744" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="535" x2="724" y1="240.2744" y2="240.2744"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="547" y="235.5322">verifyPaymentNotice req</text><path d="M730,211.3086 L730,251.3086 L1044,251.3086 L1044,221.3086 L1034,211.3086 L730,211.3086 " fill="#FBFB77" filter="url(#f138p7xaek87qb)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1034,211.3086 L1034,221.3086 L1044,221.3086 L1034,211.3086 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="289" x="736" y="228.877">The PSP requests the verification of the notice</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="740" y="244.1875">(check amount)</text><polygon fill="#A80036" points="321,290.8955,311,294.8955,321,298.8955,317,294.8955" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="315" x2="529" y1="294.8955" y2="294.8955"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="327" y="290.1533">paVerifyPaymentNotice req</text><path d="M163,265.9297 L163,305.9297 L291,305.9297 L291,275.9297 L281,265.9297 L163,265.9297 " fill="#00FFFF" filter="url(#f138p7xaek87qb)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M281,265.9297 L281,275.9297 L291,275.9297 L281,265.9297 " fill="#00FFFF" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="169" y="283.498">Debt Position</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="62" x="173" y="298.8086">STATUS =</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="37" x="239" y="298.8086">Open</text><polygon fill="#A80036" points="518,332.8613,528,336.8613,518,340.8613,522,336.8613" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="305" x2="524" y1="336.8613" y2="336.8613"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="312" y="332.1191">paVerifyPaymentNotice res</text><polygon fill="#A80036" points="713,362.1719,723,366.1719,713,370.1719,717,366.1719" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="530" x2="719" y1="366.1719" y2="366.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="537" y="361.4297">verifyPaymentNotice res</text><polygon fill="#0000FF" points="911,391.4824,921,395.4824,911,399.4824,915,395.4824" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="725" x2="917" y1="395.4824" y2="395.4824"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="732" y="390.7402">Notice verified and updated</text><rect fill="#EEEEEE" filter="url(#f138p7xaek87qb)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1058" x="0" y="424.1377"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1058" y1="424.1377" y2="424.1377"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1058" y1="427.1377" y2="427.1377"/><rect fill="#EEEEEE" filter="url(#f138p7xaek87qb)" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="116" x="471" y="413.4824"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="98" x="477" y="430.0508">activate phase</text><polygon fill="#0000FF" points="736,464.1035,726,468.1035,736,472.1035,732,468.1035" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="730" x2="922" y1="468.1035" y2="468.1035"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="742" y="463.3613">Confirm willingness to pay</text><polygon fill="#A80036" points="546,498.4141,536,502.4141,546,506.4141,542,502.4141" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="540" x2="724" y1="502.4141" y2="502.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="552" y="497.6719">activatePaymentNotice req</text><path d="M730,481.1035 L730,506.1035 L978,506.1035 L978,491.1035 L968,481.1035 L730,481.1035 " fill="#FBFB77" filter="url(#f138p7xaek87qb)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M968,481.1035 L968,491.1035 L978,491.1035 L968,481.1035 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="227" x="736" y="498.6719">The PSP requires payment activation</text><line style="stroke:#A80036;stroke-width:1.0;" x1="535" x2="577" y1="536.7246" y2="536.7246"/><line style="stroke:#A80036;stroke-width:1.0;" x1="577" x2="577" y1="536.7246" y2="549.7246"/><line style="stroke:#A80036;stroke-width:1.0;" x1="536" x2="577" y1="549.7246" y2="549.7246"/><polygon fill="#A80036" points="546,545.7246,536,549.7246,546,553.7246,542,549.7246" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="542" y="531.9824">Token generation</text><polygon fill="#A80036" points="321,587.6904,311,591.6904,321,595.6904,317,591.6904" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="315" x2="524" y1="591.6904" y2="591.6904"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="196" x="327" y="586.9482">paGetPayment req (CCP=token)</text><path d="M163,562.7246 L163,602.7246 L291,602.7246 L291,572.7246 L281,562.7246 L163,562.7246 " fill="#00FFFF" filter="url(#f138p7xaek87qb)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M281,562.7246 L281,572.7246 L291,572.7246 L281,562.7246 " fill="#00FFFF" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="169" y="580.293">Debt Position</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="62" x="173" y="595.6035">STATUS =</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="37" x="239" y="595.6035">Open</text><polygon fill="#A80036" points="513,629.6563,523,633.6563,513,637.6563,517,633.6563" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="305" x2="519" y1="633.6563" y2="633.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="312" y="628.9141">paGetPayment res</text><polygon fill="#A80036" points="713,671.6221,723,675.6221,713,679.6221,717,675.6221" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="530" x2="719" y1="675.6221" y2="675.6221"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="537" y="670.8799">activatePaymentNotice res</text><path d="M730,646.6563 L730,686.6563 L883,686.6563 L883,656.6563 L873,646.6563 L730,646.6563 " fill="#FBFB77" filter="url(#f138p7xaek87qb)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M873,646.6563 L873,656.6563 L883,656.6563 L873,646.6563 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="736" y="664.2246">The PSP has all data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="736" y="679.5352">to allow the payment</text><polygon fill="#0000FF" points="911,713.5879,921,717.5879,911,721.5879,915,717.5879" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="725" x2="917" y1="717.5879" y2="717.5879"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="732" y="712.8457">Payment page</text><path d="M5,730.5879 L5,785.5879 L296,785.5879 L296,740.5879 L286,730.5879 L5,730.5879 " fill="#FFC0CB" filter="url(#f138p7xaek87qb)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M286,730.5879 L286,740.5879 L296,740.5879 L286,730.5879 " fill="#FFC0CB" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="137" x="11" y="748.1563">Newly configured PAs</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="123" x="11" y="763.4668">DOES'NT HAVE TO</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="138" y="763.4668">lock the debt position</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="11" y="778.7773">after activation.</text><rect fill="#EEEEEE" filter="url(#f138p7xaek87qb)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1058" x="0" y="816.1748"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1058" y1="816.1748" y2="816.1748"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1058" y1="819.1748" y2="819.1748"/><rect fill="#EEEEEE" filter="url(#f138p7xaek87qb)" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="195" x="431.5" y="805.5195"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="177" x="437.5" y="822.0879">send receipt phase (push)</text><polygon fill="#0000FF" points="736,856.1406,726,860.1406,736,864.1406,732,860.1406" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="730" x2="922" y1="860.1406" y2="860.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="742" y="855.3984">Pay</text><path d="M730,873.1406 L730,913.1406 L900,913.1406 L900,883.1406 L890,873.1406 L730,873.1406 " fill="#FBFB77" filter="url(#f138p7xaek87qb)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M890,873.1406 L890,883.1406 L900,883.1406 L890,873.1406 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="736" y="890.709">If payment OK -&gt;  RT +</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="736" y="906.0195">If payment KO -&gt; RT -</text><polygon fill="#A80036" points="546,940.0723,536,944.0723,546,948.0723,542,944.0723" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="540" x2="724" y1="944.0723" y2="944.0723"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="552" y="939.3301">sendPaymentOutcome req</text><polygon fill="#A80036" points="713,969.3828,723,973.3828,713,977.3828,717,973.3828" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="530" x2="719" y1="973.3828" y2="973.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="537" y="968.6406">sendPaymentOutcome res</text><line style="stroke:#A80036;stroke-width:1.0;" x1="530" x2="572" y1="1002.6934" y2="1002.6934"/><line style="stroke:#A80036;stroke-width:1.0;" x1="572" x2="572" y1="1002.6934" y2="1015.6934"/><line style="stroke:#A80036;stroke-width:1.0;" x1="531" x2="572" y1="1015.6934" y2="1015.6934"/><polygon fill="#A80036" points="541,1011.6934,531,1015.6934,541,1019.6934,537,1015.6934" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="537" y="997.9512">RT generation</text><polygon fill="#A80036" points="321,1041.0039,311,1045.0039,321,1049.0039,317,1045.0039" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="315" x2="529" y1="1045.0039" y2="1045.0039"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="327" y="1040.2617">paSendRT req</text><polygon fill="#A80036" points="518,1090.625,528,1094.625,518,1098.625,522,1094.625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="305" x2="524" y1="1094.625" y2="1094.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="312" y="1089.8828">paSendRT res</text><path d="M48,1058.0039 L48,1113.0039 L291,1113.0039 L291,1068.0039 L281,1058.0039 L48,1058.0039 " fill="#00FFFF" filter="url(#f138p7xaek87qb)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M281,1058.0039 L281,1068.0039 L291,1068.0039 L281,1058.0039 " fill="#00FFFF" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="54" y="1075.5723">Debt Position</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="62" x="58" y="1090.8828">STATUS =</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="152" x="124" y="1090.8828">Open -&gt; Closed/Open</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="54" y="1106.1934">(based on RT result)</text><!--MD5=[d32dec465af5afd5e0dbf51e66d221b1]
@startuml uml_diag/seqdiag-wisplightnuovoModello3_newPA
title Payment process activated by the PSP

participant PA
participant Nodo
participant PSP
actor       User

== verify phase ==
User [#blue]-> PSP: Payment Notice
PSP -> Nodo: verifyPaymentNotice req
note right : The PSP requests the verification of the notice \n (check amount)
Nodo -> PA: paVerifyPaymentNotice req
note left #aqua : Debt Position\n STATUS = **Open**
activate PA
PA -> Nodo: paVerifyPaymentNotice res
deactivate PA
Nodo -> PSP: verifyPaymentNotice res
deactivate Nodo
PSP [#blue]-> User: Notice verified and updated

== activate phase ==
User [#blue]-> PSP: Confirm willingness to pay
PSP -> Nodo: activatePaymentNotice req
note right : The PSP requires payment activation
activate Nodo
Nodo -> Nodo: Token generation
Nodo -> PA: paGetPayment req (CCP=token)
note left #aqua : Debt Position\n STATUS = **Open**
activate PA
PA -> Nodo: paGetPayment res
deactivate PA
Nodo -> PSP: activatePaymentNotice res
note right : The PSP has all data \nto allow the payment
deactivate Nodo

PSP [#blue]-> User: Payment page
note left PA #pink : Newly configured PAs \n**DOES'NT HAVE TO** lock the debt position \nafter activation.

== send receipt phase (push) ==

User [#blue]-> PSP: Pay
note right PSP : If payment OK ->  RT +\nIf payment KO -> RT -


PSP -> Nodo: sendPaymentOutcome req
activate Nodo
Nodo -> PSP: sendPaymentOutcome res
deactivate Nodo
Nodo -> Nodo: RT generation
Nodo -> PA: paSendRT req
activate PA
PA -> Nodo: paSendRT res
deactivate PA
note left #aqua : Debt Position\n STATUS = **Open -> Closed/Open**\n(based on RT result)


@enduml

PlantUML version 1.2020.26(Mon Dec 21 18:45:07 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>